<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Duma Labs</title>
    
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="../../../css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.css">
	<link rel="stylesheet" href="../../../css/style.css">
        
</head>
<body class="d-flex flex-column min-vh-100"> 
    <header>
  <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm">
    <div class="container-fluid d-flex flex-column">
      <div class="d-flex justify-content-between align-items-center w-100 py-2">
        <button class="navbar-toggler d-lg-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavCollapse" aria-controls="navbarNavCollapse" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <a class="navbar-brand text-dark fw-bold mx-auto px-0" href="../../../">
          Duma Labs
        </a>

        <div class="d-lg-none" style="width: 48px;"></div> </div>

      <div class="collapse navbar-collapse justify-content-center" id="navbarNavCollapse">
        <ul class="navbar-nav">
          
            
              <li class="nav-item">
                <a class="nav-link text-dark" href="../../../about/">About Me</a>
              </li>
            
          
            
              <li class="nav-item">
                <a class="nav-link text-dark" href="../../../blog/">Blog</a>
              </li>
            
          
            
              <li class="nav-item">
                <a class="nav-link text-dark" href="../../../ttrpg/">TTRPG</a>
              </li>
            
          
            
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle text-dark" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                  Cybersecurity
                </a>
                <ul class="dropdown-menu">
                  
                    <li><a class="dropdown-item text-dark" href="../../../cybersecurity/writeups/">Write-Ups</a></li>
                  
                </ul>
              </li>
            
          
            
              <li class="nav-item">
                <a class="nav-link text-dark" href="../../../photography/">Photography</a>
              </li>
            
          
        </ul>
      </div>
    </div>
  </nav>
</header>

    <main class="flex-grow-1"> 
	
<div class="container my-5">
    <h1 class="text-center">Phishy V1</h1>
    <div>
        <h2 id="scenario">Scenario:</h2>
<p>You have been sent a phishing link. Sadly the threat actor doesn’t know who they were dealing with. From only one phishing link find out all you can about the person responsible and bring them to justice.</p>
<p>❗ <strong>WARNING</strong>
The website and kit in this lab is REAL.<br>
Exercise caution when interacting with the malicious website and do not enter any sensitive information!</p>
<p>ℹ️ <strong>INFO</strong>
As the website referenced is a live website, any references, or links to URLs, IP addresses etc in this write-up have been ‘defanged’. I do not hold any responsibility for anyone using these links.</p>
<hr>
<h2 id="process-of-investigation">Process of Investigation:</h2>
<p>After starting the lab, there was a ‘read me’ text file on the desktop. The contents of the text file are just stating that a phishing link has been sent, and the task is to find as much out about the person responsible, from using only the URL we have been provided.</p>
<p><img src="00_readme.jpg" alt="alt"></p>
<p>I opened up a web browser, and went to the URL provided, and the site loaded up, it had been made to look like a Microsoft Office 365 file download page.</p>
<p><img src="01_url.jpg" alt="alt"></p>
<p>Question 1 asks for the source of the mirror that is used on the host domain, and the first art of the tool used, so loading the page in the browser, it looked like many other error pages.</p>
<p><img src="02_domain.jpg" alt="alt"></p>
<p>Loading up the Inspector Developer Tool, I saw comments in the HTML that the page is being mirrored from <code>61[.]221[.]12[.]26/cgi-sys/defaultwebpage[.]cgi</code> by the tool <code>HTTrack Website Copier</code>.</p>
<p><img src="03_mirror_source.jpg" alt="alt"></p>
<p>Question 2 took me back to the phishing landing page to find the full URL of the background image. On this page, right clicking on the background, then opening the image in a new tab, loaded the page and displayed <code>hxxp[://]securedocument[.]net/secure/L0GIN/protected/login/portal/axCBhIt[.]png</code> in the address bar.</p>
<p><img src="04_background.jpg" alt="alt"></p>
<p>Viewing the page source for the phishing landing page, a form action pointed to <code>jeff.php</code> and with that, I had my answer to question 3.</p>
<p><img src="05_jeff.jpg" alt="alt"></p>
<p>Question 4 took a little investigating, as I had to find the zip file for the phishing kit. I didn’t see this in the page source for the domain page, or the phishing page, so I started working backwards through each folder in the URL. Eventually, I saw <code>0ff1cePh1sh.zip</code> in the index of <code>/secure/</code>.</p>
<p><img src="06_zipfile.jpg" alt="alt"></p>
<p>I saved this to a folder on my desktop for investigation, then ran the sha256sum command against it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sha256sum 0ff1cePh1sh.zip
</span></span></code></pre></div><p>This returned the hash <code>c778236f4a731411ab2f8494eb5229309713cc7ead44922b4f496a2032fa5b48</code>, giving me my answer.</p>
<p><img src="07_zip_hash.jpg" alt="alt"></p>
<p>To answer question 5 meant going into the php script and looking at the source. Here I identified a reference $recipient being assigned the email address <code>boris[.]smets[@]tfl-uk[.]co</code>.</p>
<p><img src="08_recipient.jpg" alt="alt"></p>
<p>Question 6 took a little time to figure out, and being honest, I sort of stumbled upon it. Initially, I thought the string of numbers at the end of the URL were a basic reference number. However, I noticed that this number would be different, depending on which URL I entered, and this number increased each time. I then suspected that this may be a time reference, so then checking the landing page source, I didn’t see anything, so I went back through each part of the full URL again, checking the source each time. The source for <code>/portal/</code> showed a JavaScript function that adds <code>Date().getTime()</code> to the URL.</p>
<p><img src="09_js_function.jpg" alt="alt"></p>
<p>Question 7 brought me back to the php file, as I had seen a URL in there, and it would be <code>office.com</code> that would be loaded in the browser, once credentials had been entered.</p>
<p><img src="10_redirect.jpg" alt="alt"></p>
<p>Question 8 asked for the variable name that was wrong, causing the site to break, but I noticed a couple of variables that were incorrect. The HTML page had <code>userrr</code> and the PHP file was looking for <code>user1</code> so I set this for my answer.</p>
<p><img src="11_variables.jpg" alt="alt"></p>
<hr>
<h2 id="challenge-questions-and-answers">Challenge Questions and Answers:</h2>
<ol>
<li>The HTML page used on securedocument[.]net is a decoy. Where was this webpage mirrored from, and what tool was used? <code>61[.]221[.]12[.]26/cgi-sys/defaultwebpage[.]cgi, HTTrack</code></li>
<li>What is the full URL of the background image which is on the phishing landing page? <code>hxxp[://]securedocument[.]net/secure/L0GIN/protected/login/portal/axCBhIt[.]png</code></li>
<li>What is the name of the php page which will process the stolen credentials? <code>jeff.php</code></li>
<li>What is the SHA256 of the phishing kit in ZIP format? <code>fa5b48</code></li>
<li>What email address is setup to receive the phishing credential logs? <code>boris[.]smets[@]tfl-uk[.]co</code></li>
<li>What is the function called to produce the PHP variable which appears in the index1.html URL? <code>Date().getTime()</code></li>
<li>What is the domain of the website which should appear once credentials are entered? <code>office.com</code></li>
<li>There is an error in this phishing kit. What variable name is wrong causing the phishing site to break? <code>userrr</code></li>
</ol>
<hr>
<h2 id="references">References:</h2>
<ul>
<li><a href="https://blueteamlabs.online/">https://blueteamlabs.online/</a></li>
<li><a href="https://www.securityblue.team/">https://www.securityblue.team/</a></li>
</ul>

    </div>
</div>

    </main>
    <footer class="bg-light text-center text-dark py-4 mt-auto">
  <div class="container">
    <div class="mb-3">
      <a href="https://www.linkedin.com/in/emma-du-maurier" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn Profile" class="text-dark mx-2">
        <i class="bi bi-linkedin" style="font-size: 1.5rem;"></i>
      </a>
      <a href="https://github.com/e-duMaurier" target="_blank" rel="noopener noreferrer" aria-label="GitHub Profile" class="text-dark mx-2">
        <i class="bi bi-github" style="font-size: 1.5rem;"></i>
      </a>
      <a href="https://gitlab.com/Dumaurier" target="_blank" rel="noopener noreferrer" aria-label="GitLab Profile" class="text-dark mx-2">
        <i class="bi bi-gitlab" style="font-size: 1.5rem;"></i>
      </a>
    </div>
    <div>
      &copy; Duma Labs 2025
    </div>
  </div>
</footer>

    
        <script src="../../../js/bootstrap.bundle.min.js"></script>
    
</body>
</html>
