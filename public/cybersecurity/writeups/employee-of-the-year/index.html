<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Duma Labs</title>
    
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="../../../css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.css">
	<link rel="stylesheet" href="../../../css/style.css">
        
</head>
<body class="d-flex flex-column min-vh-100"> 
    <header>
  <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm">
    <div class="container-fluid d-flex flex-column">
      <div class="d-flex justify-content-between align-items-center w-100 py-2">
        <button class="navbar-toggler d-lg-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavCollapse" aria-controls="navbarNavCollapse" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <a class="navbar-brand text-dark fw-bold mx-auto px-0" href="../../../">
          Duma Labs
        </a>

        <div class="d-lg-none" style="width: 48px;"></div> </div>

      <div class="collapse navbar-collapse justify-content-center" id="navbarNavCollapse">
        <ul class="navbar-nav">
          
            
              <li class="nav-item">
                <a class="nav-link text-dark" href="../../../about/">About Me</a>
              </li>
            
          
            
              <li class="nav-item">
                <a class="nav-link text-dark" href="../../../blog/">Blog</a>
              </li>
            
          
            
              <li class="nav-item">
                <a class="nav-link text-dark" href="../../../ttrpg/">TTRPG</a>
              </li>
            
          
            
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle text-dark" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                  Cybersecurity
                </a>
                <ul class="dropdown-menu">
                  
                    <li><a class="dropdown-item text-dark" href="../../../cybersecurity/writeups/">Write-Ups</a></li>
                  
                </ul>
              </li>
            
          
            
              <li class="nav-item">
                <a class="nav-link text-dark" href="../../../photography/">Photography</a>
              </li>
            
          
        </ul>
      </div>
    </div>
  </nav>
</header>

    <main class="flex-grow-1"> 
	
<div class="container my-5">
    <h1 class="text-center">Employee of the Year</h1>
    <div>
        <h2 id="scenario">Scenario:</h2>
<p>On a Friday evening when you were in a mood to celebrate your weekend, your team was alerted with a new RCE vulnerability actively being exploited in the wild. You have been tasked with analysing and researching the sample to collect information for the weekend team.</p>
<hr>
<h2 id="process-of-investigation">Process of Investigation:</h2>
<p>This challenge took some additional work before I could start work on the investigation. After downloading and extracting the contents of the challenge zip file, there was just one file, ‘recoverfiles.dd’.</p>
<p>I have only been using Linux as my daily driver for about 6 months now, so there’s a lot to learn, and I initially spent far too long trying to mount the image file, without success. Or rather, I managed to get the image file mounted, but it was always showing as empty, with no folder structure, and no files. It was while I was trying to research why the image was showing empty while mounted, I discovered, that I could have saved a lot of time. I could have just used a simple command to verify what some data contained may be, and so I did just that.</p>
<p>Using <code>strings recoverfiles.dd</code> I could see some information from the disk image. While a lot of the data is unreadable, due to the file being a binary file, there was some readable text, some filenames, and folders.</p>
<p><img src="00_strings.jpg" alt="alt"></p>
<p>Some of this data can be extracted with scalpel, but first the configuration file would need to be edited, so that the scalpel application can recover .gif image types, by removing the hash ‘#’ comment indicators.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nano /etc/scalpel/scalpel.conf
</span></span></code></pre></div><p><img src="01_scalpel_config.jpg" alt="alt"></p>
<p>After saving the changes to the configuration file, I created a directory to hold the recovered data, within my investigation directory, then ran scalpel against the disk image file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir recovery
</span></span><span style="display:flex;"><span>scalpel -o recovery recoverfiles.dd
</span></span></code></pre></div><p>A directory containing the recovered files, and an audit text file, were created in the selected directory. In the <code>gif-1-0</code> directory that was created, I saw a single .gif file. The file did not load all the frames when opening up in an image viewer, but there was a frame containing the text “GoodJobDefender”.</p>
<p><img src="02_image_text.jpg" alt="alt"></p>
<p>There wasn’t much more I could get from using scalpel, unless I knew the extensions of the files that I wanted to retrieve. There was another tool that could be of use here, though. Photorec can help recover lost files from disk drives.</p>
<p>I created a directory to store the recovery files, then I ran photorec against the <code>recoverfiles.dd</code> file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir rec
</span></span><span style="display:flex;"><span>sudo photorec recoverfiles.dd
</span></span></code></pre></div><p>Photorec presents several menu options at each step through the process:</p>
<ol>
<li>Selecting the media source.</li>
<li>Selecting disk or partition.</li>
<li>The filesystem type.</li>
<li>To analyse all space or free space.</li>
<li>Destination directory to recover the files to.</li>
</ol>
<p>I now had several files recovered to look through.</p>
<pre tabindex="0"><code class="language-tree" data-lang="tree">-rw-r--r-- 1 root root  93K Nov 14 22:44 f0008848.gif
-rw-r--r-- 1 root root  13K Nov 14 22:44 f0009040.pdf
-rw-r--r-- 1 root root 6.1K Feb 12  2021 f0009072.docx
-rw-r--r-- 1 root root 732K Nov 14 22:44 f0016384.mp4
-rw-r--r-- 1 root root  17K Nov 14 22:44 f0017848.png
-rw-r--r-- 1 root root 3.2K Nov 14 22:45 report.xml
</code></pre><p>I started with the other image file that had been recovered, ‘f0017848.png’. This image just contained the text “FLAG1:WELOVEBTLO”. I checked the metadata with exiftool of both of these files, and no additional information was recovered.</p>
<p><img src="03_flag1.jpg" alt="alt"></p>
<p>The metadata for the .docx file also didn’t provide any helpful data. Running the file against oleid I saw that the file wasn’t encrypted, contained no VBA or XLM macro’s or any external relationships. I still didn’t want to open the file directly, though.</p>
<p><img src="04_oleid.jpg" alt="alt"></p>
<p>Listing the contents of the file with unzip from the terminal shows there is data to be extracted, now to get to that data using</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>unzip f0009072.docx
</span></span></code></pre></div><p>With that, the files were extracted. The file I was interested in was ‘document.xml’ as this would be the likely location for any text in the document to be stored.</p>
<p><img src="06_docx_extracted.jpg" alt="alt"></p>
<p>There was not much in the XML file, but there was text, which appeared to be base64 encoded.</p>
<p><img src="07_document_xml.jpg" alt="alt"></p>
<p>The text was base64 encoded, and after putting it through CyberChef, I got the plaintext result- <code>FLAG2:ASOLIDDEFENDER</code>.</p>
<p><img src="08_flag2.jpg" alt="alt"></p>
<p>I didn’t find any further information from the DOCX file, so now I moved on to the PDF document.</p>
<p>I started with passing the file through <code>exiftool</code>, and the document author metadata is displayed as <code>FLAG3%3A%40BLU3T3AM%240LDI3R</code>.</p>
<p><img src="09_pdf_author.jpg" alt="alt"></p>
<p>This text would need to be cleaned up first, so I put the text in to the <code>URL-formatted strings decoder</code> from <a href="https://it-tools.tech/">IT-Tools</a>, and got the cleaned text <code>FLAG3:@BLU3T3AM$0LDI3R</code>.</p>
<p>Finding the filesystem of the disk image took some work. I didn’t see anything definitive for the filesystem when using photorec, and trying with fdisk, blkid, and kpartx, didn’t provide the information either. However, after some web searching, I found an article on askubuntu.com that indicated using cfdisk could be the answer, and it was the answer, displaying ext4 as the filesystem after running</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cfdisk recoverfiles.dd
</span></span></code></pre></div><p><img src="10_cfdisk.jpg" alt="alt"></p>
<p>Finally, as I had done with all the other files, I started with <code>f0016384.mp4</code> by running `exiftool against it.</p>
<p>To find the original filename of the recovered mp4 file, I went back to my first step of this process, when getting some initial data from the image file. The strings gave me several filenames, and the number of files and the extensions of these files, matched the number of files, and extensions recovered. Looking at this, I could see that the mp4 file in the original results was named <code>SBTCertifications.mp4</code>.</p>
<p><img src="11_filename.jpg" alt="alt"></p>
<hr>
<h2 id="challenge-questions-and-answers">Challenge Questions and Answers:</h2>
<p>If the challenge had specific questions to answer, list them here.</p>
<ol>
<li>What is the text written on the recovered gif image? <code>GoodJobDefender</code></li>
<li>Submit Flag1: <code>FLAG1:WELOVEBTLO</code></li>
<li>Submit Flag2: <code>FLAG2:ASOLIDDEFENDER</code></li>
<li>Submit Flag3: <code>FLAG3:@BLU3T3AM$0LDI3R</code></li>
<li>What is the filesystem of the provided disk image? <code>ext4</code></li>
<li>What is the original filename of the recovered mp4 file? <code>SBTCertifications.mp4</code></li>
</ol>
<hr>
<h2 id="references">References:</h2>
<ul>
<li><a href="https://blueteamlabs.online/">https://blueteamlabs.online/</a></li>
<li><a href="https://www.securityblue.team/">https://www.securityblue.team/</a></li>
<li><a href="https://gchq.github.io/CyberChef/">https://gchq.github.io/CyberChef/</a></li>
<li><a href="https://it-tools.tech/">https://it-tools.tech/</a></li>
<li><a href="https://manpages.ubuntu.com/manpages/xenial/man8/kpartx.8.html">https://manpages.ubuntu.com/manpages/xenial/man8/kpartx.8.html</a></li>
<li><a href="https://askubuntu.com/questions/1279716/how-to-open-dd-file-to-analyze-it">https://askubuntu.com/questions/1279716/how-to-open-dd-file-to-analyze-it</a></li>
</ul>

    </div>
</div>

    </main>
    <footer class="bg-light text-center text-dark py-4 mt-auto">
  <div class="container">
    <div class="mb-3">
      <a href="https://www.linkedin.com/in/emma-du-maurier" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn Profile" class="text-dark mx-2">
        <i class="bi bi-linkedin" style="font-size: 1.5rem;"></i>
      </a>
      <a href="https://github.com/e-duMaurier" target="_blank" rel="noopener noreferrer" aria-label="GitHub Profile" class="text-dark mx-2">
        <i class="bi bi-github" style="font-size: 1.5rem;"></i>
      </a>
      <a href="https://gitlab.com/Dumaurier" target="_blank" rel="noopener noreferrer" aria-label="GitLab Profile" class="text-dark mx-2">
        <i class="bi bi-gitlab" style="font-size: 1.5rem;"></i>
      </a>
    </div>
    <div>
      &copy; Duma Labs 2025
    </div>
  </div>
</footer>

    
        <script src="../../../js/bootstrap.bundle.min.js"></script>
    
</body>
</html>
